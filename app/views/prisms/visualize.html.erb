<% content_for :extra_head do %>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript" charset="utf-8">
    $(function() {
      setup_visualize();
      select_facet($("li.vis_facet").eq(0));
    })
  </script>
  <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
    </script>
<% end %>

    <div id="Prismabob">
    <h1><%= @prism.title.html_safe %></h1>
    <h2><%= @prism.author %></h2>

    <div class="text">
      <%= @prism.content.html_safe %>
    </div>
  </div>
  <div id="sidebar">
    <div id="visualizations">
      <p id="visualization-help"><%= t "visualize.instructions" %> </p>

		<div id="chart_div" style="width: 450px; height: 250px;"></div>
      <ul id="highlighters">
        <% for facet in @prism.facets %>
          <li class="vis_facet vis_button">
            <input type="hidden" class="color" value="<%=facet.color%>"/>
            <input type="hidden" class="order" value="<%=facet.order%>"/>
            <input type="hidden" value="<%=@frequencies[facet.order]%>" class="freq"/>
            <span class="facet <%=facet.order%> <%=facet.color%>"></span><%=facet.description%></li>
        <% end %>

		  	 <li class="vis_button">
			 	<input type="hidden" class="color" value="winning"/>
			 	<input type="hidden" class="order" value=""/>
            <input type="hidden" value="<%=@frequencies[0]%>" class="freq"/>
			 	<span class="facet red green blue"></span>Winning Facet 
			 </li>

		<span class="current-word" style="visibility:hidden"></span>
		<ul id="mousevoer-stats" style="visibility:hidden">
			<li><span class="red-percent red-vis"></span></li>
			<li><span class="green-percent green-vis"></span></li>
			<li><span class="blue-percent blue-vis"></span></li>
   	</ul>

  <p id="visualization-help"><%= t "visualize.instructions" %> </p>
     
      </ul>
      <p><%= render 'cc_license' %></p>
      <p id="viz-count">
      <span><% if @prism.word_markings.map(&:user_id).uniq != nil %>
          <%=@prism.word_markings.map(&:user_id).uniq.size %></span> <% if @prism.word_markings.map(&:user_id).uniq.size == 1%>user <% else%>users <%end%>contributed to this visualization.
    <% end %>
    </p>
    

    </div>
  </div>
</div>

