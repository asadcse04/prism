<script type='text/javascript' src="http://people.virginia.edu/~err8n/html-editor/tinymce/jquery.tinymce.js"></script>
<script type="text/javascript" charset="utf-8">
  jQuery().ready(function() {
      var textarea = jQuery('textarea.tinymce');
      var tiny = textarea.tinymce({
          script_url: 'http://people.virginia.edu/~err8n/html-editor/tinymce/tiny_mce.js',
          readonly: true,

          theme: 'advanced',
          theme_advanced_buttons1: "",
          theme_advanced_buttons2: "",
          theme_advanced_buttons3: "",
          theme_advanced_toolbar_location: "external",
          content_css: 'http://people.virginia.edu/~err8n/html-editor/tinymce.css',

          setup: function(ed) {
            ed.onInit.add(function(ed) {
                ed.dom.bind(ed.dom.get('tinymce'), 'mouseup', function(e) {
                    var selection = ed.selection;
                    // Step 1: Abort if it's empty
                    var content = selection.getContent();
                    if (content.length === 0) {
                      return;
                    }
                    // Step 2: Find the elements in which it starts and stops
                    // Step 3: Figure out which word # the endpoints fall in
                    // Step 4: Figure out the character indices of the start of the first word and end of the last word, respectively, and move the selection to include the whole words
                    // Step 5: Highlight the selected area in tinymce
                    ed.execCommand('hilitecolor', false, 'silver');
                    // Step 6: Add the indices of the highlighted words to the hidden input
                  });
              });
          }
        });
      });
</script>
<div class="page-margin">
  <div id="Prismabob">
    <h1><%= @document.title %></h1>
    <h2><%= @document.author %></h2>

    <textarea id='editor' name="editor" class='tinymce' cols="80" rows="20">
      <%= @document.content.html_safe %>
    </textarea>
    </div>
  </div>
  <form action="." method="POST">
      <input type="hidden" value="" name="indices" id="indices"/>
      <input type="submit" value="Submit" />
  </form>
  <div id="tools">
      <ul id="highlighters">
        <li>Daddy Issues</li>
        <li>Dumpling Truck</li>
        <li>Pesky Bird Issues</li>
        <li class="selected">Eyebrow Threading Problems</li>
      </ul>
      <p id="highlighter-help">Twee umami carles whatever wes anderson, pitchfork williamsburg +1 brunch DIY letterpress sustainable mixtape sriracha master cleanse. Ethnic whatever messenger bag, cliche portland irony thundercats butcher vegan brunch master cleanse bushwick. Kale chips lo-fi semiotics pour-over viral, squid tofu brooklyn before they sold out twee letterpress ethical. Brunch before they sold out PBR tattooed terry richardson, echo park keffiyeh VHS sustainable authentic brooklyn mcsweeney's readymade. Put a bird on it odd future beard, pinterest narwhal messenger bag marfa. Fingerstache hoodie gentrify salvia synth. Flexitarian retro before they sold out squid post-ironic etsy VHS tattooed, cray pinterest single-origin coffee tumblr.
      </p>
  </div>
</div>


